import{_ as B}from"./_plugin-vue_export-helper-BGiHQUbd.js";import{E as b}from"./index-CTocSTSQ.js";import"./index-D1BevRgO.js";import{N as x}from"./index-x_6tzstu.js";import{d as L,j as N,r as A,o as E,B as o,l as r,q as a,f as c,s as l,v as I,I as S,L as $,F as _,x as u,z as D,$ as m,a0 as n,A as F}from"./index-BzANx2fI.js";import{u as V}from"./index-Das1Xvnf.js";import{T as j}from"./TicketCard-Dj5XU2Pu.js";import{s as p}from"./function-call-D6jw9k5t.js";import"./use-id-TOkFT5fl.js";import"./use-route-8cfyQcNc.js";import"./index-Er0kk77V.js";import"./Dialog-BRrkhBu1.js";const q={class:"page-container trash-page"},z={class:"tip-bar"},M={key:0,class:"loading-wrapper"},R={key:0,class:"empty-state"},G={key:1,class:"ticket-list"},H=L({__name:"index",setup(J){N();const s=V(),d=A(!0);E(async()=>{try{await s.loadTrashTickets()}catch{o("加载失败")}finally{d.value=!1}});const k=t=>{f(t)},f=async t=>{try{const e=await p({title:t.name,message:"选择操作",showCancelButton:!0,cancelButtonText:"永久删除",confirmButtonText:"恢复票迹",cancelButtonColor:"#ee0a24"});await h(t)}catch(e){e==="cancel"&&await y(t)}},h=async t=>{m({message:"恢复中...",forbidClick:!0});try{await s.recoverTicket(String(t.id)),n(),o({message:"已恢复",type:"success"})}catch{n(),o("恢复失败")}},y=async t=>{try{await p({title:"确认永久删除",message:"删除后将无法恢复，确定要永久删除吗？"}),m({message:"删除中...",forbidClick:!0}),s.trashTickets=s.trashTickets.filter(e=>e.id!==t.id),n(),o({message:"已永久删除",type:"success"})}catch{n()}},g=async()=>{if(s.trashTickets.length===0){o("回收站为空");return}try{await p({title:"清空回收站",message:"此操作将永久删除回收站中的所有票迹，无法恢复！"}),m({message:"清空中...",forbidClick:!0}),s.trashTickets=[],n(),o({message:"已清空",type:"success"})}catch{n()}};return(t,e)=>{const T=x,v=S,w=$,C=b;return a(),r("div",q,[c(T,{title:"回收站","left-arrow":"",onClickLeft:e[0]||(e[0]=i=>t.$router.back())},{right:I(()=>[l("span",{class:"clear-btn",onClick:g},"清空")]),_:1}),l("div",z,[c(v,{name:"info-o"}),e[1]||(e[1]=l("span",null,"回收站中的票迹将在 30 天后自动永久删除",-1))]),d.value?(a(),r("div",M,[c(w,{type:"spinner"})])):(a(),r(_,{key:1},[u(s).trashTickets.length===0?(a(),r("div",R,[c(C,{description:"回收站是空的"})])):(a(),r("div",G,[(a(!0),r(_,null,D(u(s).trashTickets,i=>(a(),F(j,{key:i.id,ticket:i,onClick:k},null,8,["ticket"]))),128))]))],64))])}}}),at=B(H,[["__scopeId","data-v-c52b7253"]]);export{at as default};
