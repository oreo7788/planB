import{_ as Oe}from"./_plugin-vue_export-helper-BGiHQUbd.js";import{B as yt}from"./index-D1BevRgO.js";import{F as Ee,f as et}from"./index-CE6vXKKR.js";/* empty css              */import{C as ft}from"./index-6dJEcpSY.js";import{C as tt}from"./index-rG4-5EJY.js";import{N as gt}from"./index-x_6tzstu.js";import{c as J,C as R,D as ht,E as he,d as Y,G as pe,H as ce,n as fe,r as E,b as bt,k as U,J as nt,K as oe,M as kt,e as at,f as s,p as be,N as Le,O as re,m as K,P as ot,Q as Ct,w as G,R as Z,L as lt,S as ae,T as ke,U as _e,V as wt,g as Re,i as se,W as Tt,X as it,Y as Ke,l as W,q as H,s as j,I as ut,Z as Se,A as X,F as Pe,_ as q,$ as De,a0 as te,B as L,v as $,a1 as ue,a2 as Ye,t as ye,a3 as ct,z as Vt,a4 as xt,j as _t,o as St,x as Te,y as Pt}from"./index-BzANx2fI.js";import{u as Dt,T as Ve,P as ze}from"./index-Das1Xvnf.js";import{I as It}from"./index-Er0kk77V.js";import{E as Ot}from"./index-CTocSTSQ.js";import{D as Et}from"./index-DmqS5IRg.js";import{u as Mt}from"./use-id-TOkFT5fl.js";import"./use-route-8cfyQcNc.js";import"./Dialog-BRrkhBu1.js";const[Nt,z,Ge]=J("picker"),rt=e=>e.find(a=>!a.disabled)||e[0];function Ut(e,a){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(a.children in n)return"cascade"}return"default"}function ge(e,a){a=he(a,0,e.length);for(let n=a;n<e.length;n++)if(!e[n].disabled)return n;for(let n=a-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const qe=(e,a,n)=>a!==void 0&&e.some(i=>i[n.value]===a);function Ie(e,a,n){const i=e.findIndex(h=>h[n.value]===a),r=ge(e,i);return e[r]}function At(e,a,n){const i=[];let r={[a.children]:e},h=0;for(;r&&r[a.children];){const o=r[a.children],l=n.value[h];if(r=ht(l)?Ie(o,l,a):void 0,!r&&o.length){const C=rt(o)[a.value];r=Ie(o,C,a)}h++,i.push(o)}return i}function $t(e){const{transform:a}=window.getComputedStyle(e),n=a.slice(7,a.length-1).split(", ")[5];return Number(n)}function Ht(e){return R({text:"text",value:"value",children:"children"},e)}const Xe=200,We=300,Bt=15,[st,xe]=J("picker-column"),dt=Symbol(st);var Ft=Y({name:st,props:{value:fe,fields:pe(Object),options:ce(),readonly:Boolean,allowHtml:Boolean,optionHeight:pe(Number),swipeDuration:pe(fe),visibleOptionNum:pe(fe)},emits:["change","clickOption","scrollInto"],setup(e,{emit:a,slots:n}){let i,r,h,o,l;const C=E(),P=E(),f=E(0),b=E(0),p=bt(),k=()=>e.options.length,V=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,M=D=>{let N=ge(e.options,D);const v=-N*e.optionHeight,y=()=>{N>k()-1&&(N=ge(e.options,D));const O=e.options[N][e.fields.value];O!==e.value&&a("change",O)};i&&v!==f.value?l=y:y(),f.value=v},c=()=>e.readonly||!e.options.length,w=D=>{i||c()||(l=null,b.value=Xe,M(D),a("clickOption",e.options[D]))},T=D=>he(Math.round(-D/e.optionHeight),0,k()-1),x=U(()=>T(f.value)),S=(D,N)=>{const v=Math.abs(D/N);D=f.value+v/.003*(D<0?-1:1);const y=T(D);b.value=+e.swipeDuration,M(y)},t=()=>{i=!1,b.value=0,l&&(l(),l=null)},m=D=>{if(!c()){if(p.start(D),i){const N=$t(P.value);f.value=Math.min(0,N-V())}b.value=0,r=f.value,h=Date.now(),o=r,l=null}},u=D=>{if(c())return;p.move(D),p.isVertical()&&(i=!0,be(D,!0));const N=he(r+p.deltaY.value,-(k()*e.optionHeight),e.optionHeight),v=T(N);v!==x.value&&a("scrollInto",e.options[v]),f.value=N;const y=Date.now();y-h>We&&(h=y,o=N)},B=()=>{if(c())return;const D=f.value-o,N=Date.now()-h;if(N<We&&Math.abs(D)>Bt){S(D,N);return}const y=T(f.value);b.value=Xe,M(y),setTimeout(()=>{i=!1},0)},A=()=>{const D={height:`${e.optionHeight}px`};return e.options.map((N,v)=>{const y=N[e.fields.text],{disabled:O}=N,d=N[e.fields.value],g={role:"button",style:D,tabindex:O?-1:0,class:[xe("item",{disabled:O,selected:d===e.value}),N.className],onClick:()=>w(v)},I={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:y};return s("li",g,[n.option?n.option(N,v):s("div",I,null)])})};return nt(dt),oe({stopMomentum:t}),kt(()=>{const D=i?Math.floor(-f.value/e.optionHeight):e.options.findIndex(y=>y[e.fields.value]===e.value),N=ge(e.options,D),v=-N*e.optionHeight;i&&N<D&&t(),f.value=v}),at("touchmove",u,{target:C}),()=>s("div",{ref:C,class:xe(),onTouchstartPassive:m,onTouchend:B,onTouchcancel:B},[s("ul",{ref:P,style:{transform:`translate3d(0, ${f.value+V()}px, 0)`,transitionDuration:`${b.value}ms`,transitionProperty:b.value?"all":"none"},class:xe("wrapper"),onTransitionend:t},[A()])])}});const[jt]=J("picker-toolbar"),Ce={title:String,cancelButtonText:String,confirmButtonText:String},Lt=["cancel","confirm","title","toolbar"],Rt=Object.keys(Ce);var Kt=Y({name:jt,props:Ce,emits:["confirm","cancel"],setup(e,{emit:a,slots:n}){const i=()=>{if(n.title)return n.title();if(e.title)return s("div",{class:[z("title"),"van-ellipsis"]},[e.title])},r=()=>a("cancel"),h=()=>a("confirm"),o=()=>{var C;const P=(C=e.cancelButtonText)!=null?C:Ge("cancel");if(!(!n.cancel&&!P))return s("button",{type:"button",class:[z("cancel"),Le],onClick:r},[n.cancel?n.cancel():P])},l=()=>{var C;const P=(C=e.confirmButtonText)!=null?C:Ge("confirm");if(!(!n.confirm&&!P))return s("button",{type:"button",class:[z("confirm"),Le],onClick:h},[n.confirm?n.confirm():P])};return()=>s("div",{class:z("toolbar")},[n.toolbar?n.toolbar():[o(),i(),l()]])}});const[Yt]=J("picker-group"),zt=Symbol(Yt);R({tabs:ce(),activeTab:K(0),nextStepText:String,showToolbar:re},Ce);const Me=R({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:K(44),showToolbar:re,swipeDuration:K(1e3),visibleOptionNum:K(6)},Ce),Gt=R({},Me,{columns:ce(),modelValue:ce(),toolbarPosition:_e("top"),columnsFieldNames:Object});var qt=Y({name:Nt,props:Gt,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:a,slots:n}){const i=E(),r=E(e.modelValue.slice(0)),{parent:h}=nt(zt),{children:o,linkChildren:l}=ot(dt);l();const C=U(()=>Ht(e.columnsFieldNames)),P=U(()=>Ct(e.optionHeight)),f=U(()=>Ut(e.columns,C.value)),b=U(()=>{const{columns:v}=e;switch(f.value){case"multiple":return v;case"cascade":return At(v,C.value,r);default:return[v]}}),p=U(()=>b.value.some(v=>v.length)),k=U(()=>b.value.map((v,y)=>Ie(v,r.value[y],C.value))),V=U(()=>b.value.map((v,y)=>v.findIndex(O=>O[C.value.value]===r.value[y]))),M=(v,y)=>{if(r.value[v]!==y){const O=r.value.slice(0);O[v]=y,r.value=O}},c=()=>({selectedValues:r.value.slice(0),selectedOptions:k.value,selectedIndexes:V.value}),w=(v,y)=>{M(y,v),f.value==="cascade"&&r.value.forEach((O,d)=>{const g=b.value[d];qe(g,O,C.value)||M(d,g.length?g[0][C.value.value]:void 0)}),Re(()=>{a("change",R({columnIndex:y},c()))})},T=(v,y)=>{const O={columnIndex:y,currentOption:v};a("clickOption",R(c(),O)),a("scrollInto",O)},x=()=>{o.forEach(y=>y.stopMomentum());const v=c();return Re(()=>{const y=c();a("confirm",y)}),v},S=()=>a("cancel",c()),t=()=>b.value.map((v,y)=>s(Ft,{value:r.value[y],fields:C.value,options:v,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:P.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:O=>w(O,y),onClickOption:O=>T(O,y),onScrollInto:O=>{a("scrollInto",{currentOption:O,columnIndex:y})}},{option:n.option})),m=v=>{if(p.value){const y={height:`${P.value}px`},O={backgroundSize:`100% ${(v-P.value)/2}px`};return[s("div",{class:z("mask"),style:O},null),s("div",{class:[wt,z("frame")],style:y},null)]}},u=()=>{const v=P.value*+e.visibleOptionNum,y={height:`${v}px`};return!e.loading&&!p.value&&n.empty?n.empty():s("div",{ref:i,class:z("columns"),style:y},[t(),m(v)])},B=()=>{if(e.showToolbar&&!h)return s(Kt,ke(ae(e,Rt),{onConfirm:x,onCancel:S}),ae(n,Lt))},A=v=>{v.forEach((y,O)=>{y.length&&!qe(y,r.value[O],C.value)&&M(O,rt(y)[C.value.value])})};G(b,v=>A(v),{immediate:!0});let D;return G(()=>e.modelValue,v=>{!Z(v,r.value)&&!Z(v,D)&&(r.value=v.slice(0),D=v.slice(0)),e.modelValue.length===0&&A(b.value)},{deep:!0}),G(r,v=>{Z(v,e.modelValue)||(D=v.slice(0),a("update:modelValue",D))},{immediate:!0}),at("touchmove",be,{target:i}),oe({confirm:x,getSelectedOptions:()=>k.value}),()=>{var v,y;return s("div",{class:z()},[e.toolbarPosition==="top"?B():null,e.loading?s(lt,{class:z("loading")},null):null,(v=n["columns-top"])==null?void 0:v.call(n),u(),(y=n["columns-bottom"])==null?void 0:y.call(n),e.toolbarPosition==="bottom"?B():null])}}});const Ne=se(qt),[Xt,Wt]=J("form"),Zt={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:fe,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:re,showErrorMessage:re,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var Jt=Y({name:Xt,props:Zt,emits:["submit","failed"],setup(e,{emit:a,slots:n}){const{children:i,linkChildren:r}=ot(Tt),h=c=>c?i.filter(w=>c.includes(w.name)):i,o=c=>new Promise((w,T)=>{const x=[];h(c).reduce((t,m)=>t.then(()=>{if(!x.length)return m.validate().then(u=>{u&&x.push(u)})}),Promise.resolve()).then(()=>{x.length?T(x):w()})}),l=c=>new Promise((w,T)=>{const x=h(c);Promise.all(x.map(S=>S.validate())).then(S=>{S=S.filter(Boolean),S.length?T(S):w()})}),C=c=>{const w=i.find(T=>T.name===c);return w?new Promise((T,x)=>{w.validate().then(S=>{S?x(S):T()})}):Promise.reject()},P=c=>typeof c=="string"?C(c):e.validateFirst?o(c):l(c),f=c=>{typeof c=="string"&&(c=[c]),h(c).forEach(T=>{T.resetValidation()})},b=()=>i.reduce((c,w)=>(c[w.name]=w.getValidationStatus(),c),{}),p=(c,w)=>{i.some(T=>T.name===c?(T.$el.scrollIntoView(w),!0):!1)},k=()=>i.reduce((c,w)=>(w.name!==void 0&&(c[w.name]=w.formValue.value),c),{}),V=()=>{const c=k();P().then(()=>a("submit",c)).catch(w=>{a("failed",{values:c,errors:w});const{scrollToError:T,scrollToErrorPosition:x}=e;T&&w[0].name&&p(w[0].name,x?{block:x}:void 0)})},M=c=>{be(c),V()};return r({props:e}),oe({submit:V,validate:P,getValues:k,scrollToField:p,resetValidation:f,getValidationStatus:b}),()=>{var c;return s("form",{class:Wt(),onSubmit:M},[(c=n.default)==null?void 0:c.call(n)])}}});const Qt=se(Jt),mt=R({},Me,{modelValue:ce(),filter:Function,formatter:{type:Function,default:(e,a)=>a}}),vt=Object.keys(Me);function en(e,a){if(e<0)return[];const n=Array(e);let i=-1;for(;++i<e;)n[i]=a(i);return n}const tn=(e,a)=>32-new Date(e,a-1,32).getDate(),ne=(e,a,n,i,r,h)=>{const o=en(a-e+1,l=>{const C=it(e+l);return i(n,{text:C,value:C})});return r?r(n,o,h):o},pt=(e,a)=>e.map((n,i)=>{const r=a[i];if(r.length){const h=+r[0].value,o=+r[r.length-1].value;return it(he(+n,h,o))}return n}),Ze=new Date().getFullYear(),[nn]=J("date-picker"),an=R({},mt,{columnsType:{type:Array,default:()=>["year","month","day"]},minDate:{type:Date,default:()=>new Date(Ze-10,0,1),validator:Ke},maxDate:{type:Date,default:()=>new Date(Ze+10,11,31),validator:Ke}});var on=Y({name:nn,props:an,emits:["confirm","cancel","change","update:modelValue"],setup(e,{emit:a,slots:n}){const i=E(e.modelValue),r=E(!1),h=E(),o=U(()=>r.value?e.modelValue:i.value),l=t=>t===e.minDate.getFullYear(),C=t=>t===e.maxDate.getFullYear(),P=t=>t===e.minDate.getMonth()+1,f=t=>t===e.maxDate.getMonth()+1,b=t=>{const{minDate:m,columnsType:u}=e,B=u.indexOf(t),A=o.value[B];if(A)return+A;switch(t){case"year":return m.getFullYear();case"month":return m.getMonth()+1;case"day":return m.getDate()}},p=()=>{const t=e.minDate.getFullYear(),m=e.maxDate.getFullYear();return ne(t,m,"year",e.formatter,e.filter,o.value)},k=()=>{const t=b("year"),m=l(t)?e.minDate.getMonth()+1:1,u=C(t)?e.maxDate.getMonth()+1:12;return ne(m,u,"month",e.formatter,e.filter,o.value)},V=()=>{const t=b("year"),m=b("month"),u=l(t)&&P(m)?e.minDate.getDate():1,B=C(t)&&f(m)?e.maxDate.getDate():tn(t,m);return ne(u,B,"day",e.formatter,e.filter,o.value)},M=()=>{var t;return(t=h.value)==null?void 0:t.confirm()},c=()=>i.value,w=U(()=>e.columnsType.map(t=>{switch(t){case"year":return p();case"month":return k();case"day":return V();default:return[]}}));G(i,t=>{Z(t,e.modelValue)||a("update:modelValue",t)}),G(()=>e.modelValue,(t,m)=>{r.value=Z(m,i.value),t=pt(t,w.value),Z(t,i.value)||(i.value=t),r.value=!1},{immediate:!0});const T=(...t)=>a("change",...t),x=(...t)=>a("cancel",...t),S=(...t)=>a("confirm",...t);return oe({confirm:M,getSelectedDate:c}),()=>s(Ne,ke({ref:h,modelValue:i.value,"onUpdate:modelValue":t=>i.value=t,columns:w.value,onChange:T,onCancel:x,onConfirm:S},ae(e,vt)),n)}});const ln=se(on),[un,ie,cn]=J("search"),rn=R({},et,{label:String,shape:_e("square"),leftIcon:_e("search"),clearable:re,actionText:String,background:String,showAction:Boolean});var sn=Y({name:un,props:rn,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:a,slots:n,attrs:i}){const r=Mt(),h=E(),o=()=>{n.action||(a("update:modelValue",""),a("cancel"))},l=t=>{t.keyCode===13&&(be(t),a("search",e.modelValue))},C=()=>e.id||`${r}-input`,P=()=>{if(n.label||e.label)return s("label",{class:ie("label"),for:C(),"data-allow-mismatch":"attribute"},[n.label?n.label():e.label])},f=()=>{if(e.showAction){const t=e.actionText||cn("cancel");return s("div",{class:ie("action"),role:"button",tabindex:0,onClick:o},[n.action?n.action():t])}},b=()=>{var t;return(t=h.value)==null?void 0:t.blur()},p=()=>{var t;return(t=h.value)==null?void 0:t.focus()},k=t=>a("blur",t),V=t=>a("focus",t),M=t=>a("clear",t),c=t=>a("clickInput",t),w=t=>a("clickLeftIcon",t),T=t=>a("clickRightIcon",t),x=Object.keys(et),S=()=>{const t=R({},i,ae(e,x),{id:C()}),m=u=>a("update:modelValue",u);return s(Ee,ke({ref:h,type:"search",class:ie("field",{"with-message":t.errorMessage}),border:!1,labelAlign:"left",onBlur:k,onFocus:V,onClear:M,onKeypress:l,onClickInput:c,onClickLeftIcon:w,onClickRightIcon:T,"onUpdate:modelValue":m},t),ae(n,["left-icon","right-icon"]))};return oe({focus:p,blur:b}),()=>{var t;return s("div",{class:ie({"show-action":e.showAction}),style:{background:e.background}},[(t=n.left)==null?void 0:t.call(n),s("div",{class:ie("content",e.shape)},[P(),S()]),f()])}}});const dn=se(sn),[mn]=J("time-picker"),Je=e=>/^([01]\d|2[0-3]):([0-5]\d):([0-5]\d)$/.test(e),vn=["hour","minute","second"],pn=R({},mt,{minHour:K(0),maxHour:K(23),minMinute:K(0),maxMinute:K(59),minSecond:K(0),maxSecond:K(59),minTime:{type:String,validator:Je},maxTime:{type:String,validator:Je},columnsType:{type:Array,default:()=>["hour","minute"]}});var yn=Y({name:mn,props:pn,emits:["confirm","cancel","change","update:modelValue"],setup(e,{emit:a,slots:n}){const i=E(e.modelValue),r=E(),h=p=>{const k=p.split(":");return vn.map((V,M)=>e.columnsType.includes(V)?k[M]:"00")},o=()=>{var p;return(p=r.value)==null?void 0:p.confirm()},l=()=>i.value,C=U(()=>{let{minHour:p,maxHour:k,minMinute:V,maxMinute:M,minSecond:c,maxSecond:w}=e;if(e.minTime||e.maxTime){const T={hour:0,minute:0,second:0};e.columnsType.forEach((t,m)=>{var u;T[t]=(u=i.value[m])!=null?u:0});const{hour:x,minute:S}=T;if(e.minTime){const[t,m,u]=h(e.minTime);p=t,V=+x<=+p?m:"00",c=+x<=+p&&+S<=+V?u:"00"}if(e.maxTime){const[t,m,u]=h(e.maxTime);k=t,M=+x>=+k?m:"59",w=+x>=+k&&+S>=+M?u:"59"}}return e.columnsType.map(T=>{const{filter:x,formatter:S}=e;switch(T){case"hour":return ne(+p,+k,T,S,x,i.value);case"minute":return ne(+V,+M,T,S,x,i.value);case"second":return ne(+c,+w,T,S,x,i.value);default:return[]}})});G(i,p=>{Z(p,e.modelValue)||a("update:modelValue",p)}),G(()=>e.modelValue,p=>{p=pt(p,C.value),Z(p,i.value)||(i.value=p)},{immediate:!0});const P=(...p)=>a("change",...p),f=(...p)=>a("cancel",...p),b=(...p)=>a("confirm",...p);return oe({confirm:o,getSelectedTime:l}),()=>s(Ne,ke({ref:r,modelValue:i.value,"onUpdate:modelValue":p=>i.value=p,columns:C.value,onChange:P,onCancel:f,onConfirm:b},ae(e,vt)),n)}});const fn=se(yn),gn={class:"image-uploader"},hn=Y({__name:"ImageUploader",props:{modelValue:{}},emits:["update:modelValue","upload-success"],setup(e,{emit:a}){const n=e,i=a,r=E(n.modelValue||""),h=E(!1);G(()=>n.modelValue,f=>{r.value=f||""});const o=(f,b=.8)=>new Promise((p,k)=>{const V=new FileReader;V.onload=M=>{var w;const c=new Image;c.onload=()=>{const T=document.createElement("canvas"),x=1200;let{width:S,height:t}=c;(S>x||t>x)&&(S>t?(t=t/S*x,S=x):(S=S/t*x,t=x)),T.width=S,T.height=t,T.getContext("2d").drawImage(c,0,0,S,t),p(T.toDataURL("image/jpeg",b))},c.onerror=k,c.src=(w=M.target)==null?void 0:w.result},V.onerror=k,V.readAsDataURL(f)}),l=async()=>{try{if(h.value=!0,q.isMiniProgram()){De({message:"处理中...",forbidClick:!0});const f=await q.chooseImage();r.value=f.url,i("update:modelValue",f.url),i("upload-success",f),te(),L({message:"添加成功",type:"success"})}else{const f=document.createElement("input");f.type="file",f.accept="image/*",f.onchange=async b=>{var k;const p=(k=b.target.files)==null?void 0:k[0];if(p)try{De({message:"处理中...",forbidClick:!0});const V=await o(p,.8);r.value=V,i("update:modelValue",V),i("upload-success",{url:V,thumbnailUrl:V}),te(),L({message:"添加成功",type:"success"})}catch{te(),L({message:"处理失败",type:"fail"})}},f.click()}}catch(f){te(),f.message!=="user_cancel"&&L({message:"处理失败",type:"fail"})}finally{h.value=!1}},C=()=>{r.value="",i("update:modelValue",void 0)},P=()=>{r.value};return(f,b)=>{const p=It,k=ut,V=lt;return H(),W("div",gn,[r.value?(H(),W("div",{key:0,class:"image-preview",onClick:P},[s(p,{src:r.value,fit:"cover"},null,8,["src"]),j("div",{class:"delete-btn",onClick:Se(C,["stop"])},[s(k,{name:"cross"})])])):(H(),W("div",{key:1,class:"upload-btn",onClick:l},[h.value?(H(),X(V,{key:0,type:"spinner"})):(H(),W(Pe,{key:1},[s(k,{name:"photograph",size:"28",color:"#ddd"}),b[0]||(b[0]=j("span",{class:"upload-text"},"上传照片",-1))],64))]))])}}}),bn=Oe(hn,[["__scopeId","data-v-ad139958"]]),Qe=[{code:"PEK",name:"北京首都国际机场",city:"北京",pinyin:"beijing shoudu"},{code:"PKX",name:"北京大兴国际机场",city:"北京",pinyin:"beijing daxing"},{code:"PVG",name:"上海浦东国际机场",city:"上海",pinyin:"shanghai pudong"},{code:"SHA",name:"上海虹桥国际机场",city:"上海",pinyin:"shanghai hongqiao"},{code:"CAN",name:"广州白云国际机场",city:"广州",pinyin:"guangzhou baiyun"},{code:"SZX",name:"深圳宝安国际机场",city:"深圳",pinyin:"shenzhen baoan"},{code:"CTU",name:"成都双流国际机场",city:"成都",pinyin:"chengdu shuangliu"},{code:"TFU",name:"成都天府国际机场",city:"成都",pinyin:"chengdu tianfu"},{code:"CKG",name:"重庆江北国际机场",city:"重庆",pinyin:"chongqing jiangbei"},{code:"HGH",name:"杭州萧山国际机场",city:"杭州",pinyin:"hangzhou xiaoshan"},{code:"NKG",name:"南京禄口国际机场",city:"南京",pinyin:"nanjing lukou"},{code:"WUH",name:"武汉天河国际机场",city:"武汉",pinyin:"wuhan tianhe"},{code:"XIY",name:"西安咸阳国际机场",city:"西安",pinyin:"xian xianyang"},{code:"KMG",name:"昆明长水国际机场",city:"昆明",pinyin:"kunming changshui"},{code:"CSX",name:"长沙黄花国际机场",city:"长沙",pinyin:"changsha huanghua"},{code:"CGO",name:"郑州新郑国际机场",city:"郑州",pinyin:"zhengzhou xinzheng"},{code:"TAO",name:"青岛胶东国际机场",city:"青岛",pinyin:"qingdao jiaodong"},{code:"XMN",name:"厦门高崎国际机场",city:"厦门",pinyin:"xiamen gaoqi"},{code:"TSN",name:"天津滨海国际机场",city:"天津",pinyin:"tianjin binhai"},{code:"DLC",name:"大连周水子国际机场",city:"大连",pinyin:"dalian zhoushuizi"},{code:"SHE",name:"沈阳桃仙国际机场",city:"沈阳",pinyin:"shenyang taoxian"},{code:"HRB",name:"哈尔滨太平国际机场",city:"哈尔滨",pinyin:"haerbin taiping"},{code:"HAK",name:"海口美兰国际机场",city:"海口",pinyin:"haikou meilan"},{code:"SYX",name:"三亚凤凰国际机场",city:"三亚",pinyin:"sanya fenghuang"},{code:"FOC",name:"福州长乐国际机场",city:"福州",pinyin:"fuzhou changle"},{code:"KHN",name:"南昌昌北国际机场",city:"南昌",pinyin:"nanchang changbei"},{code:"HFE",name:"合肥新桥国际机场",city:"合肥",pinyin:"hefei xinqiao"},{code:"TNA",name:"济南遥墙国际机场",city:"济南",pinyin:"jinan yaoqiang"},{code:"TYN",name:"太原武宿国际机场",city:"太原",pinyin:"taiyuan wusu"},{code:"SJW",name:"石家庄正定国际机场",city:"石家庄",pinyin:"shijiazhuang zhengding"},{code:"CGQ",name:"长春龙嘉国际机场",city:"长春",pinyin:"changchun longjia"},{code:"KWE",name:"贵阳龙洞堡国际机场",city:"贵阳",pinyin:"guiyang longdongbao"},{code:"NNG",name:"南宁吴圩国际机场",city:"南宁",pinyin:"nanning wuxu"},{code:"LHW",name:"兰州中川国际机场",city:"兰州",pinyin:"lanzhou zhongchuan"},{code:"URC",name:"乌鲁木齐地窝堡国际机场",city:"乌鲁木齐",pinyin:"wulumuqi diwopu"},{code:"INC",name:"银川河东国际机场",city:"银川",pinyin:"yinchuan hedong"},{code:"XNN",name:"西宁曹家堡国际机场",city:"西宁",pinyin:"xining caojiapu"},{code:"HET",name:"呼和浩特白塔国际机场",city:"呼和浩特",pinyin:"huhehaote baita"},{code:"LXA",name:"拉萨贡嘎国际机场",city:"拉萨",pinyin:"lasa gongga"},{code:"ZUH",name:"珠海金湾机场",city:"珠海",pinyin:"zhuhai jinwan"},{code:"WUX",name:"无锡硕放机场",city:"无锡",pinyin:"wuxi shuofang"},{code:"NGB",name:"宁波栎社国际机场",city:"宁波",pinyin:"ningbo lishe"},{code:"WNZ",name:"温州龙湾国际机场",city:"温州",pinyin:"wenzhou longwan"},{code:"YNT",name:"烟台蓬莱国际机场",city:"烟台",pinyin:"yantai penglai"},{code:"WEH",name:"威海大水泊国际机场",city:"威海",pinyin:"weihai dashuipo"},{code:"KWL",name:"桂林两江国际机场",city:"桂林",pinyin:"guilin liangjiang"},{code:"LJG",name:"丽江三义国际机场",city:"丽江",pinyin:"lijiang sanyi"},{code:"JHG",name:"西双版纳嘎洒国际机场",city:"西双版纳",pinyin:"xishuangbanna gasa"},{code:"DYG",name:"张家界荷花国际机场",city:"张家界",pinyin:"zhangjiajie hehua"},{code:"JZH",name:"九寨黄龙机场",city:"九寨沟",pinyin:"jiuzhaigou huanglong"},{code:"HKG",name:"香港国际机场",city:"香港",pinyin:"xianggang"},{code:"MFM",name:"澳门国际机场",city:"澳门",pinyin:"aomen"},{code:"TPE",name:"台北桃园国际机场",city:"台北",pinyin:"taibei taoyuan"},{code:"TSA",name:"台北松山机场",city:"台北",pinyin:"taibei songshan"},{code:"NRT",name:"东京成田国际机场",city:"东京",pinyin:"dongjing chengtan"},{code:"HND",name:"东京羽田国际机场",city:"东京",pinyin:"dongjing yutian"},{code:"ICN",name:"首尔仁川国际机场",city:"首尔",pinyin:"shouer renchuan"},{code:"GMP",name:"首尔金浦国际机场",city:"首尔",pinyin:"shouer jinpu"},{code:"SIN",name:"新加坡樟宜机场",city:"新加坡",pinyin:"xinjiapo zhangyi"},{code:"BKK",name:"曼谷素万那普机场",city:"曼谷",pinyin:"mangu suwannap"},{code:"KUL",name:"吉隆坡国际机场",city:"吉隆坡",pinyin:"jilongpo"},{code:"DXB",name:"迪拜国际机场",city:"迪拜",pinyin:"dibai"},{code:"LHR",name:"伦敦希思罗机场",city:"伦敦",pinyin:"lundun xisilu"},{code:"CDG",name:"巴黎戴高乐机场",city:"巴黎",pinyin:"bali daigaole"},{code:"FRA",name:"法兰克福机场",city:"法兰克福",pinyin:"falankefu"},{code:"LAX",name:"洛杉矶国际机场",city:"洛杉矶",pinyin:"luosanji"},{code:"JFK",name:"纽约肯尼迪机场",city:"纽约",pinyin:"niuyue kennidi"},{code:"SFO",name:"旧金山国际机场",city:"旧金山",pinyin:"jiujinshan"},{code:"SYD",name:"悉尼金斯福德机场",city:"悉尼",pinyin:"xini"}];function kn(e){if(!e.trim())return Qe.slice(0,20);const a=e.toLowerCase().trim();return Qe.filter(n=>n.code.toLowerCase().includes(a)||n.name.includes(a)||n.city.includes(a)||n.pinyin&&n.pinyin.includes(a)).slice(0,20)}const Cn={class:"location-picker"},wn={class:"code-badge"},Tn={class:"code-badge"},Vn={class:"airport-picker"},xn={class:"airport-picker-header"},_n={class:"title"},Sn={class:"airport-list"},Pn={class:"airport-code"},Dn=Y({__name:"LocationPicker",props:{modelValue:{},type:{},ticketType:{}},emits:["update:modelValue"],setup(e,{emit:a}){const n=e,i=a,r=U(()=>n.type||"single"),h=U(()=>n.ticketType==="flight"),o=E({city:"",address:"",latitude:0,longitude:0}),l=E({departure:{city:"",station:"",code:"",time:"",latitude:0,longitude:0},arrival:{city:"",station:"",code:"",time:"",latitude:0,longitude:0}});G(()=>n.modelValue,d=>{var g,I,F,Q,le,ee,de,me,ve,_,we,Ue,Ae,$e,He,Be,Fe,je;d&&(d.type==="single"?o.value={city:d.city||"",address:d.address||"",latitude:((g=d.coordinate)==null?void 0:g.latitude)||0,longitude:((I=d.coordinate)==null?void 0:I.longitude)||0}:d.type==="route"&&(l.value={departure:{city:((F=d.departure)==null?void 0:F.city)||"",station:((Q=d.departure)==null?void 0:Q.station)||"",code:((le=d.departure)==null?void 0:le.code)||"",time:((ee=d.departure)==null?void 0:ee.time)||"",latitude:((me=(de=d.departure)==null?void 0:de.coordinate)==null?void 0:me.latitude)||0,longitude:((_=(ve=d.departure)==null?void 0:ve.coordinate)==null?void 0:_.longitude)||0},arrival:{city:((we=d.arrival)==null?void 0:we.city)||"",station:((Ue=d.arrival)==null?void 0:Ue.station)||"",code:((Ae=d.arrival)==null?void 0:Ae.code)||"",time:(($e=d.arrival)==null?void 0:$e.time)||"",latitude:((Be=(He=d.arrival)==null?void 0:He.coordinate)==null?void 0:Be.latitude)||0,longitude:((je=(Fe=d.arrival)==null?void 0:Fe.coordinate)==null?void 0:je.longitude)||0}}))},{immediate:!0});const C=E(!1),P=E(!1),f=E(!1),b=E(!1),p=E(!1),k=E(""),V=E(""),M=E(!1),c=E(""),w=E("departure"),T=U(()=>kn(c.value)),x=d=>{w.value=d,c.value="",M.value=!0},S=d=>{const g=w.value;l.value[g]={...l.value[g],city:d.city,station:d.name,code:d.code},M.value=!1,y()},t=async()=>{if(q.isMiniProgram())try{const d=await q.chooseLocation();o.value={city:d.city,address:d.address,latitude:d.latitude,longitude:d.longitude},y()}catch(d){d.message!=="user_cancel"&&L("选择位置失败")}else k.value=o.value.city,C.value=!0},m=()=>{o.value.city=k.value,C.value=!1,y()},u=async()=>{if(h.value){x("departure");return}if(q.isMiniProgram())try{const d=await q.chooseLocation();l.value.departure={...l.value.departure,city:d.city,station:d.address,latitude:d.latitude,longitude:d.longitude},y()}catch(d){d.message!=="user_cancel"&&L("选择位置失败")}else k.value=l.value.departure.city,V.value=l.value.departure.code,P.value=!0},B=()=>{l.value.departure.city=k.value,l.value.departure.code=V.value.toUpperCase(),P.value=!1,y()},A=async()=>{if(h.value){x("arrival");return}if(q.isMiniProgram())try{const d=await q.chooseLocation();l.value.arrival={...l.value.arrival,city:d.city,station:d.address,latitude:d.latitude,longitude:d.longitude},y()}catch(d){d.message!=="user_cancel"&&L("选择位置失败")}else k.value=l.value.arrival.city,V.value=l.value.arrival.code,f.value=!0},D=()=>{l.value.arrival.city=k.value,l.value.arrival.code=V.value.toUpperCase(),f.value=!1,y()},N=({selectedValues:d})=>{l.value.departure.time=d.join(":"),b.value=!1,y()},v=({selectedValues:d})=>{l.value.arrival.time=d.join(":"),p.value=!1,y()},y=()=>{r.value==="single"?o.value.city||o.value.address?i("update:modelValue",{type:"single",city:o.value.city,address:o.value.address,coordinate:o.value.latitude?{latitude:o.value.latitude,longitude:o.value.longitude}:void 0}):i("update:modelValue",void 0):l.value.departure.city||l.value.arrival.city?i("update:modelValue",{type:"route",departure:{city:l.value.departure.city,station:l.value.departure.station,code:l.value.departure.code||void 0,time:l.value.departure.time||void 0,coordinate:l.value.departure.latitude?{latitude:l.value.departure.latitude,longitude:l.value.departure.longitude}:void 0},arrival:{city:l.value.arrival.city,station:l.value.arrival.station,code:l.value.arrival.code||void 0,time:l.value.arrival.time||void 0,coordinate:l.value.arrival.latitude?{latitude:l.value.arrival.latitude,longitude:l.value.arrival.longitude}:void 0}}):i("update:modelValue",void 0)},O=()=>{r.value==="single"?o.value={city:"",address:"",latitude:0,longitude:0}:l.value={departure:{city:"",station:"",code:"",time:"",latitude:0,longitude:0},arrival:{city:"",station:"",code:"",time:"",latitude:0,longitude:0}},i("update:modelValue",void 0)};return(d,g)=>{const I=ut,F=Ee,Q=Et,le=fn,ee=ct,de=dn,me=tt,ve=Ot;return H(),W("div",Cn,[r.value==="single"?(H(),X(F,{key:0,modelValue:o.value.city,"onUpdate:modelValue":g[0]||(g[0]=_=>o.value.city=_),label:"城市",placeholder:"点击输入城市",readonly:"","is-link":"",onClick:t},{"right-icon":$(()=>[o.value.city?(H(),X(I,{key:0,name:"clear",onClick:Se(O,["stop"])})):ue("",!0)]),_:1},8,["modelValue"])):(H(),W(Pe,{key:1},[s(F,{"model-value":h.value?l.value.departure.station:l.value.departure.city,label:h.value?"出发机场":"出发地",placeholder:h.value?"点击选择出发机场":"点击输入出发地",readonly:"","is-link":"",onClick:u},Ye({_:2},[l.value.departure.code?{name:"extra",fn:$(()=>[j("span",wn,ye(l.value.departure.code),1)]),key:"0"}:void 0]),1032,["model-value","label","placeholder"]),s(F,{"model-value":l.value.departure.time,label:"出发时间",placeholder:"选填",readonly:"","is-link":"",onClick:g[1]||(g[1]=_=>b.value=!0)},null,8,["model-value"]),s(F,{"model-value":h.value?l.value.arrival.station:l.value.arrival.city,label:h.value?"到达机场":"到达地",placeholder:h.value?"点击选择到达机场":"点击输入到达地",readonly:"","is-link":"",onClick:A},Ye({_:2},[l.value.arrival.code?{name:"extra",fn:$(()=>[j("span",Tn,ye(l.value.arrival.code),1)]),key:"0"}:void 0]),1032,["model-value","label","placeholder"]),s(F,{"model-value":l.value.arrival.time,label:"到达时间",placeholder:"选填",readonly:"","is-link":"",onClick:g[2]||(g[2]=_=>p.value=!0)},{"right-icon":$(()=>[l.value.departure.city||l.value.arrival.city?(H(),X(I,{key:0,name:"clear",onClick:Se(O,["stop"])})):ue("",!0)]),_:1},8,["model-value"])],64)),s(Q,{show:C.value,"onUpdate:show":g[4]||(g[4]=_=>C.value=_),title:"输入城市","show-cancel-button":"",onConfirm:m},{default:$(()=>[s(F,{modelValue:k.value,"onUpdate:modelValue":g[3]||(g[3]=_=>k.value=_),placeholder:"请输入城市名称"},null,8,["modelValue"])]),_:1},8,["show"]),s(Q,{show:P.value,"onUpdate:show":g[7]||(g[7]=_=>P.value=_),title:"输入出发地","show-cancel-button":"",onConfirm:B},{default:$(()=>[s(F,{modelValue:k.value,"onUpdate:modelValue":g[5]||(g[5]=_=>k.value=_),label:"城市",placeholder:"如：北京"},null,8,["modelValue"]),s(F,{modelValue:V.value,"onUpdate:modelValue":g[6]||(g[6]=_=>V.value=_),label:"机场代码",placeholder:"如：PEK（选填）",maxlength:"3"},null,8,["modelValue"])]),_:1},8,["show"]),s(Q,{show:f.value,"onUpdate:show":g[10]||(g[10]=_=>f.value=_),title:"输入到达地","show-cancel-button":"",onConfirm:D},{default:$(()=>[s(F,{modelValue:k.value,"onUpdate:modelValue":g[8]||(g[8]=_=>k.value=_),label:"城市",placeholder:"如：上海"},null,8,["modelValue"]),s(F,{modelValue:V.value,"onUpdate:modelValue":g[9]||(g[9]=_=>V.value=_),label:"机场代码",placeholder:"如：SHA（选填）",maxlength:"3"},null,8,["modelValue"])]),_:1},8,["show"]),s(ee,{show:b.value,"onUpdate:show":g[12]||(g[12]=_=>b.value=_),position:"bottom"},{default:$(()=>[s(le,{title:"出发时间",onConfirm:N,onCancel:g[11]||(g[11]=_=>b.value=!1)})]),_:1},8,["show"]),s(ee,{show:p.value,"onUpdate:show":g[14]||(g[14]=_=>p.value=_),position:"bottom"},{default:$(()=>[s(le,{title:"到达时间",onConfirm:v,onCancel:g[13]||(g[13]=_=>p.value=!1)})]),_:1},8,["show"]),s(ee,{show:M.value,"onUpdate:show":g[17]||(g[17]=_=>M.value=_),position:"bottom",style:{height:"70%"},round:""},{default:$(()=>[j("div",Vn,[j("div",xn,[j("span",_n,ye(w.value==="departure"?"选择出发机场":"选择到达机场"),1),s(I,{name:"cross",size:"20",onClick:g[15]||(g[15]=_=>M.value=!1)})]),s(de,{modelValue:c.value,"onUpdate:modelValue":g[16]||(g[16]=_=>c.value=_),placeholder:"搜索城市、机场名称或三字码",shape:"round",autofocus:""},null,8,["modelValue"]),j("div",Sn,[(H(!0),W(Pe,null,Vt(T.value,_=>(H(),X(me,{key:_.code,title:_.name,label:_.city,clickable:"",onClick:we=>S(_)},{value:$(()=>[j("span",Pn,ye(_.code),1)]),_:2},1032,["title","label","onClick"]))),128)),T.value.length===0?(H(),X(ve,{key:0,description:"未找到相关机场"})):ue("",!0)])])]),_:1},8,["show"])])}}}),In=Oe(Dn,[["__scopeId","data-v-2cdef560"]]),On={class:"page-container add-page"},En={class:"image-section"},Mn={class:"submit-section"},Nn=Y({__name:"index",setup(e){const a=xt(),n=_t(),i=Dt(),r=U(()=>!!a.params.id),h=U(()=>a.params.id),o=E({name:"",type:"movie",tripNumber:void 0,tags:[],price:void 0,photo:void 0,date:void 0,location:void 0,note:void 0,privacy:"public"}),l=Object.entries(Ve).map(([m,u])=>({value:m,text:u.label})),C=Object.entries(ze).map(([m,u])=>({value:m,text:u.label})),P=E(!1),f=E(!1),b=E(!1),p=U(()=>Ve[o.value.type]),k=U(()=>["train","flight"].includes(o.value.type)?"route":"single"),V=U(()=>["train","flight"].includes(o.value.type)),M=U(()=>o.value.date?o.value.date.split("T")[0]:"");St(async()=>{if(r.value)try{const m=await i.loadTicketDetail(h.value);o.value={name:m.name,type:m.type,tripNumber:m.tripNumber,tags:Array.isArray(m.tags)?m.tags:[],price:m.price,photo:m.photo,date:m.date,location:m.location||void 0,note:m.note,privacy:m.privacy}}catch{L("加载失败"),n.back()}});const c=({selectedOptions:m})=>{const u=m[0].value;o.value.type=u,["train","flight"].includes(u)&&(o.value.name=Ve[u].label),P.value=!1},w=({selectedValues:m})=>{const[u,B,A]=m;o.value.date=`${u}-${B}-${A}T00:00:00Z`,f.value=!1},T=({selectedOptions:m})=>{o.value.privacy=m[0].value,b.value=!1},x=m=>{o.value.photo=m.url},S=async()=>{if(V.value&&!o.value.name.trim()&&(o.value.name=p.value.label),!o.value.name.trim()){L("请输入票据名称");return}De({message:"保存中...",forbidClick:!0});try{r.value?await i.editTicket(h.value,o.value):await i.addTicket(o.value),te(),L({message:"保存成功",type:"success"}),n.back()}catch{te(),L("保存失败")}},t=()=>{n.back()};return(m,u)=>{const B=gt,A=Ee,D=tt,N=ft,v=yt,y=Qt,O=Ne,d=ct,g=ln;return H(),W("div",On,[s(B,{title:r.value?"编辑票迹":"添加票迹","left-arrow":"",onClickLeft:t},null,8,["title"]),s(y,{onSubmit:S},{default:$(()=>[j("div",En,[s(bn,{modelValue:o.value.photo,"onUpdate:modelValue":u[0]||(u[0]=I=>o.value.photo=I),onUploadSuccess:x},null,8,["modelValue"])]),s(N,{inset:""},{default:$(()=>[V.value?ue("",!0):(H(),X(A,{key:0,modelValue:o.value.name,"onUpdate:modelValue":u[1]||(u[1]=I=>o.value.name=I),label:"名称",placeholder:"请输入票据名称",required:"",maxlength:"50","show-word-limit":""},null,8,["modelValue"])),s(A,{modelValue:p.value.label,"onUpdate:modelValue":u[2]||(u[2]=I=>p.value.label=I),label:"类型",placeholder:"请选择类型",readonly:"","is-link":"",onClick:u[3]||(u[3]=I=>P.value=!0)},null,8,["modelValue"]),V.value?(H(),X(A,{key:1,modelValue:o.value.tripNumber,"onUpdate:modelValue":u[4]||(u[4]=I=>o.value.tripNumber=I),label:o.value.type==="flight"?"航班号":"车次",placeholder:o.value.type==="flight"?"如 CA1234":"如 G1234",maxlength:"20"},null,8,["modelValue","label","placeholder"])):ue("",!0),s(A,{"model-value":M.value,label:"日期",placeholder:"请选择日期",readonly:"","is-link":"",onClick:u[5]||(u[5]=I=>f.value=!0)},null,8,["model-value"]),s(D,{title:"地点"},{value:$(()=>[s(In,{modelValue:o.value.location,"onUpdate:modelValue":u[6]||(u[6]=I=>o.value.location=I),type:k.value,"ticket-type":o.value.type},null,8,["modelValue","type","ticket-type"])]),_:1}),s(A,{modelValue:o.value.price,"onUpdate:modelValue":u[7]||(u[7]=I=>o.value.price=I),modelModifiers:{number:!0},label:"价格",type:"number",placeholder:"选填"},{"right-icon":$(()=>[...u[16]||(u[16]=[j("span",{class:"price-unit"},"元",-1)])]),_:1},8,["modelValue"]),s(A,{modelValue:o.value.note,"onUpdate:modelValue":u[8]||(u[8]=I=>o.value.note=I),label:"感想",type:"textarea",placeholder:"记录你的心情...",rows:"3",maxlength:"500","show-word-limit":""},null,8,["modelValue"]),s(A,{"model-value":Te(ze)[o.value.privacy].label,label:"隐私",readonly:"","is-link":"",onClick:u[9]||(u[9]=I=>b.value=!0)},null,8,["model-value"])]),_:1}),j("div",Mn,[s(v,{round:"",block:"",type:"primary","native-type":"submit"},{default:$(()=>[...u[17]||(u[17]=[Pt(" 保存 ",-1)])]),_:1})])]),_:1}),s(d,{show:P.value,"onUpdate:show":u[11]||(u[11]=I=>P.value=I),position:"bottom"},{default:$(()=>[s(O,{columns:Te(l),onConfirm:c,onCancel:u[10]||(u[10]=I=>P.value=!1)},null,8,["columns"])]),_:1},8,["show"]),s(d,{show:f.value,"onUpdate:show":u[13]||(u[13]=I=>f.value=I),position:"bottom"},{default:$(()=>[s(g,{onConfirm:w,onCancel:u[12]||(u[12]=I=>f.value=!1)})]),_:1},8,["show"]),s(d,{show:b.value,"onUpdate:show":u[15]||(u[15]=I=>b.value=I),position:"bottom"},{default:$(()=>[s(O,{columns:Te(C),onConfirm:T,onCancel:u[14]||(u[14]=I=>b.value=!1)},null,8,["columns"])]),_:1},8,["show"])])}}}),Wn=Oe(Nn,[["__scopeId","data-v-0e8796c7"]]);export{Wn as default};
